import 'package:directus_api_manager/directus_api_manager.dart';
import 'package:vr_web_admin/page/listexplointant_viewmode.dart';
import 'package:vr_web_admin/models/user_detail.dart';

//@DirectusCollection()
//@CollectionMetadata(endpointName: "users_details")
class ExploitantUseCases extends DirectusItem implements IExploitantUseCases {
  final DirectusApiManager _apiManager;
  List<dynamic> params = [];

  ExploitantUseCases(this._apiManager) : super.newItem();

  // @override
  // Future<String?> getRS(String? id) async {
  //   String idReal = id.toString();

  //   final UsersDetails oneManager = await _apiManager.getSpecificItem(id: "1");
  //   return oneManager.identification;
  // }
  @override
  Future<List<DirectusUser>> getListExploitant() async {
    return List<DirectusUser>.from(await _apiManager.getDirectusUserList());
  }

// cette fonction pose problème par l'admin n'est pas présent dans SessionDetail !!!
  @override
  Future<List> getInfo(String? idCurrentManager) async {
    final List<UsersDetails> listUser;
    try {
      listUser = List<UsersDetails>.from(
          await _apiManager.findListOfItems<UsersDetails>());
      final Iterable<UsersDetails> filteredID = listUser
          .where((listUser) => listUser.identification == idCurrentManager);
      if (filteredID.isNotEmpty) {
        params.insert(0, filteredID.first.rs);
        params.insert(1, filteredID.first.inscription);
        params.insert(2, filteredID.first.autorised);
      }
      return params;
    } catch (exe) {
      print(exe);
      throw false;
    }
  }
}
